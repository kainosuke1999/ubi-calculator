# UBI実現可能性シミュレーター - TODO

## 機能実装

### コア機能
- [x] UBI計算ロジックの実装
- [x] パラメーター入力UI（スライダー）の実装
- [x] 結果表示UIの実装
- [x] プリセットシナリオ機能の実装
- [x] パラメーター設定の永続化（AsyncStorage）

### UI/UX
- [x] アプリアイコンの生成とブランディング設定
- [ ] ダークモード対応の確認
- [ ] レスポンシブレイアウトの実装
- [ ] 片手操作を考慮したUI調整

### オプション機能
- [ ] 税収内訳グラフの表示
- [ ] 情報画面（パラメーター説明）の実装
- [ ] シナリオ比較機能

## テスト
- [x] 計算ロジックの検証
- [x] UI動作確認
- [x] パフォーマンステスト

## 機能改善
- [x] 社会維持コスト（GDP比）をパラメーターとして追加
- [x] 1人あたりGDP倍率をパラメーターとして追加

## バグ修正
- [x] 社会維持コストのデフォルト値を30%から16.8%に修正
- [x] 現状シナリオの税収がGDP比19.6%になるよう税率を調整

## 最終確認
- [ ] 法人税率と消費税率が実際の日本の現状とフィットしているか再確認
- [ ] 修正した数値をユーザーに確認してもらう

## モデルの根本的修正
- [x] 社会保険料維持率パラメーターを追加（0-100%）
- [x] 社会維持コストを正しく再計算（社会保険料を考慮）
- [x] 税率設定を再検証

## 税収調整
- [x] 税収調整係数パラメーターを追加（モデルと実際の税収のギャップを調整）
- [x] 現状シナリオの税率を実際の値に更新（個人8%、法人30%、消費10%、固定資産1.7%）

## 財政赤字の考慮
- [x] 財政赤字率パラメーターを追加（GDP比、0-10%）
- [x] 現状シナリオを財政赤字率 4.5% に設定
- [x] モデルの計算式を修正（税収に赤字を加算）
- [x] UIに財政赤字情報を追加表示
- [x] ユニットテストを更新して全テスト合格

## NaN表示バグ修正
- [x] NaN表示の原因を特定（UIの表示ロジックに問題）
- [x] 計算ロジックを修正（formatNumber関数でNaN/Infinityチェック追加）
- [x] UIで正しく数値が表示されることを確認
- [x] ユニットテストを実行して回帰バグがないことを確認（12件合格）

## 財政赤字率変更時の計算ロジック検証
- [ ] 財政赤字率を0%にした場合の計算結果を確認
- [ ] 財政赤字率4.5%と0%の差分が正しく反映されているか検証
- [ ] 必要に応じて計算ロジックを修正
- [ ] ユニットテストを実行して正しい動作を確認

## 社会維持コストの正しい設定
- [ ] 日本の実際の政府支出データを再調査
- [ ] 現状でUBI給付余剰がマイナスになるよう社会維持コストを調整
- [ ] 現状シナリオのパラメーターを更新
- [ ] 他のシナリオも合わせて調整

## 動的社会維持コストの実装
- [x] 社会維持コストを固定コストと社会保障コストに分解
- [x] UBI給付額に応じて社会保障コストが削減されるロジックを実装
- [x] パラメーターにfixedCostRatioとsocialSecurityReductionRateを追加
- [x] 計算ロジックを反復計算に変更（最大5回反復）
- [x] 全シナリオのパラメーターを更新
- [x] ユニットテストを更新（12件合格）
- [x] 現状シナリオでUBI給付不可（純財政余剰-46兆円）を確認

## 現状シナリオのパラメーター再検証
- [x] 日本の実際の所得税率を調査（実効税率約8%で正確）
- [x] 日本の実際の法人税率を調査（実効税率約30%で正確）
- [x] 財政赤字率の正確な値を確認（4.5%→3.6%に修正）
- [x] 現状シナリオのパラメーターを修正
- [x] ユニットテストを更新（12件合格）

## パラメーター調整UI
- [x] カスタムシナリオ用のパラメーター編集画面を作成（既存のスライダーUIを利用）
- [x] 固定コスト率スライダーを追加
- [x] 社会保障削減率スライダーを追加
- [x] その他の主要パラメーターのスライダーを追加（全パラメーター調整可能）
- [x] カスタムシナリオの保存機能を実装（AsyncStorageで自動保存）

## シナリオ比較グラフ
- [x] 4シナリオの月額UBI給付額を棒グラフで表示
- [x] グラフライブラリ（react-native-svg + d3）を導入（シンプルCSSバーグラフで実装）
- [x] グラフコンポーネントを作成（ScenarioComparisonChart）
- [x] 比較画面に統合（ホーム画面に追加）

## 詳細説明モーダル
- [x] モーダルコンポーネントを作成（InfoModal）
- [x] 各パラメーターの説明文を作成（13種類のパラメーター説明）
- [x] 「？」アイコンをタップでモーダル表示
- [x] 計算式の説明も追加（calculationキー）

## 論文修正に基づくアプリ更新（2026年2月1日）
- [ ] 財政赤字率を3.6%から4.8%に修正（28.7兆円 ÷ 600兆円）
- [ ] scenarios.tsの現状シナリオを更新
- [ ] ユニットテストを実行して動作確認（12件すべて合格を確認）
- [ ] チェックポイントを保存

## 論文完全版対応：インフレ率・実質購買力の実装（2026年2月1日）
- [ ] インフレ感応度パラメーター（η = 0.2）を追加
- [ ] インフレ率計算ロジックを実装（π = η · Total_UBI / GDP）
- [ ] 実質購買力を計算（名目UBI ÷ (1 + π)）
- [ ] 生産性係数（γ）を計算結果に追加
- [ ] 社会保障削減額を計算結果に追加
- [ ] GDP調整後の値を計算結果に追加
- [ ] 財政赤字率を3.6%から4.8%に修正
- [ ] 結果表示UIにインフレ率を追加
- [ ] 結果表示UIに実質購買力を追加
- [ ] 結果表示UIに生産性係数を追加
- [ ] 結果表示UIに社会保障削減額を追加
- [ ] ユニットテストを更新（インフレ率関連テスト追加）
- [ ] 論文の4シナリオ結果と照合して検証
- [ ] チェックポイントを保存

## 税率感応度モデル対応（2026年2月1日）
- [ ] ユニットテストの期待値を修正（提案ケース: 90万円→70万円）
- [ ] 全ユニットテストが合格することを確認
- [ ] 論文の4シナリオ結果を再計算
- [ ] 論文に「生産性係数の内生化」セクションを追加
- [ ] 論文の「政策的含意」セクションを修正
- [ ] 論文PDFを再生成
- [ ] アプリのチェックポイントを保存

## ハイブリッドアプローチ実装（2026年2月1日）
- [x] ユニットテストを修正（λ=0.3の結果を正として受け入れる）
- [x] 全ユニットテストが合格することを確認
- [ ] 論文の4シナリオをケースB（λ=0.3）で再計算
- [ ] 論文に「3.3 税率感応度の考慮」セクションを追加
- [ ] 論文の表2を拡張（ケースAとケースBを併記）
- [ ] 論文の政策的含意セクションを修正
- [ ] 論文PDFを再生成
- [ ] アプリのチェックポイントを保存
